<!DOCTYPE html>
<html>
<head>
    <title>Simple Image Upload Test</title>
    <meta name="csrf-token" content="{{ csrf_token() }}">
</head>
<body>
    <h1>Simple Image Upload Test</h1>
    
    <form id="testForm">
        <p>Inspector Name: <input type="text" id="inspector_name" name="inspector_name" value="Test Inspector" required></p>
        <p>Take Photo: <input type="file" id="photo" accept="image/*" capture="environment"></p>
        <p>Upload PDF: <input type="file" id="pdf" accept=".pdf"></p>
        <p>Diagnostic Text: <textarea id="diagnostic_report" name="diagnostic_report">Test diagnostic report</textarea></p>
        <button type="button" onclick="testSubmit()">Test Submit</button>
    </form>
    
    <div id="results"></div>
    
    <script>
    function testSubmit() {
        console.log('=== SIMPLE TEST STARTING ===');
        
        const photoFile = document.getElementById('photo').files[0];
        const pdfFile = document.getElementById('pdf').files[0];
        const diagnosticText = document.getElementById('diagnostic_report').value;
        
        console.log('Photo file:', photoFile);
        console.log('PDF file:', pdfFile);
        console.log('Diagnostic text:', diagnosticText);
        
        if (photoFile) {
            console.log('Photo details:', photoFile.name, photoFile.size, photoFile.type);
        }
        
        if (pdfFile) {
            console.log('PDF details:', pdfFile.name, pdfFile.size, pdfFile.type);
        }
        
        // Test API call with minimal data
        const testData = {
            inspector_name: 'Simple Test Inspector',
            client_name: 'Simple Test Client',
            vin: 'SIMPLE123',
            manufacturer: 'Test',
            model: 'Test',
            diagnostic_report: diagnosticText,
            images: []
        };
        
        fetch('/api/inspection/visual', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content'),
            },
            body: JSON.stringify(testData)
        })
        .then(response => {
            console.log('Response status:', response.status);
            return response.json();
        })
        .then(result => {
            console.log('API Result:', result);
            document.getElementById('results').innerHTML = '<p>SUCCESS: Inspection ID ' + result.inspection_id + '</p>';
        })
        .catch(error => {
            console.error('API Error:', error);
            document.getElementById('results').innerHTML = '<p>ERROR: ' + error.message + '</p>';
        });
    }
    </script>
</body>
</html>